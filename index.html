<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <!-- 核心适配：解决不同系统视口、缩放、点击延迟、渲染模式问题 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="webkit-tap-highlight-color" content="transparent">
    <!-- 适配鸿蒙/安卓系统的缓存与渲染优化 -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>太平宫重建庆典 - 官方网站</title>
    
    <!-- 优先加载核心样式库，减少渲染阻塞 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    
    <!-- 字体加载优化：适配不同系统的中文字体回退 -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#C41E3A', // 中国红
                        secondary: '#FFD700', // 金黄色
                        accent: '#FF6B35', // 橙红色
                        dark: '#8B0000', // 深红色
                        light: '#FFF8E7', // 米白色
                    },
                    fontFamily: {
                        serif: ['Noto Serif SC', 'STSong', 'SimSun', 'serif'],
                        sans: ['Inter', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'sans-serif'],
                    },
                    // 增加响应式断点，适配更多设备尺寸（覆盖各品牌手机/平板）
                    screens: {
                        'xs': '320px',    // 小屏手机（旧款vivo/OPPO）
                        'sm': '375px',    // 主流手机
                        'md': '768px',    // 平板
                        'lg': '1024px',   // 笔记本
                        'xl': '1280px',   // 台式机
                        '2xl': '1536px',  // 大屏显示器
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            }
            .bg-opacity-80 {
                background-opacity: 0.8;
            }
            .scroll-smooth {
                scroll-behavior: smooth;
            }
            .hover-scale {
                transition: transform 0.3s ease;
            }
            .hover-scale:hover {
                transform: scale(1.03);
            }
            /* 适配鸿蒙/安卓系统滚动条样式 */
            .custom-scrollbar::-webkit-scrollbar {
                width: 6px;
                height: 6px;
            }
            .custom-scrollbar::-webkit-scrollbar-thumb {
                background-color: rgba(196, 30, 58, 0.5);
                border-radius: 3px;
            }
            .custom-scrollbar::-webkit-scrollbar-track {
                background-color: rgba(255, 248, 231, 0.1);
            }
            /* 修复轮播图变红问题：重置图片滤镜/混合模式 */
            .carousel-img {
                filter: none !important;
                mix-blend-mode: normal !important;
                -webkit-filter: none !important;
            }
            /* 适配鸿蒙/安卓系统的按钮点击样式 */
            .sys-btn {
                -webkit-appearance: none;
                appearance: none;
                outline: none;
                border: none;
            }
            /* 解决部分安卓系统文字渲染模糊问题 */
            .text-clear {
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
                text-rendering: optimizeLegibility;
            }
            /* 邀请函样式优化 */
            .invitation-text {
                text-indent: 2em; /* 段前空两格 */
                line-height: 2;
                margin-bottom: 1em;
            }
            .invitation-title {
                line-height: 2;
                margin-bottom: 1em;
            }
            .invitation落款 {
                text-align: right;
                margin-top: 2em;
                line-height: 1.8;
            }
        }
    </style>
</head>
<!-- 全局适配：解决不同系统body滚动/渲染问题 -->
<body class="font-serif bg-light text-dark scroll-smooth custom-scrollbar text-clear">
    <!-- 顶部导航栏：适配不同系统的固定定位与响应式 -->
    <header id="navbar" class="fixed w-full top-0 z-50 transition-all duration-300 bg-white/90 shadow-md">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <!-- Logo -->
            <a href="#home" class="flex items-center space-x-2">
                <div class="w-10 h-10 bg-primary rounded-md flex items-center justify-center">
                    <span class="text-white text-xl font-bold">太</span>
                </div>
                <span class="text-xl font-bold text-primary">太平宫重建庆典</span>
            </a>

            <!-- 桌面端导航 -->
            <nav class="hidden md:flex items-center space-x-8">
                <a href="#home" class="text-dark hover:text-primary transition-colors font-medium">首页</a>
                <a href="#process" class="text-dark hover:text-primary transition-colors font-medium">活动流程</a>
                <a href="#overview" class="text-dark hover:text-primary transition-colors font-medium">庆典概况</a>
                <a href="#registration" class="text-dark hover:text-primary transition-colors font-medium">报名通道</a>
                <!-- 立即报名按钮 - 适配不同系统的按钮样式 -->
                <a href="#registration" class="sys-btn bg-primary text-white px-4 py-2 rounded-md hover:bg-primary/90 transition-colors">
                    立即报名
                </a>
            </nav>

            <!-- 移动端菜单按钮：适配不同系统的点击交互 -->
            <button id="menuBtn" class="sys-btn md:hidden text-dark text-2xl">
                <i class="fa fa-bars"></i>
            </button>
        </div>

        <!-- 移动端导航菜单：适配不同系统的弹窗样式 -->
        <div id="mobileMenu" class="md:hidden hidden bg-white shadow-lg absolute w-full">
            <div class="container mx-auto px-4 py-3 flex flex-col space-y-4">
                <a href="#home" class="text-dark hover:text-primary transition-colors font-medium py-2 border-b border-gray-100">首页</a>
                <a href="#process" class="text-dark hover:text-primary transition-colors font-medium py-2 border-b border-gray-100">活动流程</a>
                <a href="#overview" class="text-dark hover:text-primary transition-colors font-medium py-2 border-b border-gray-100">庆典概况</a>
                <a href="#registration" class="text-dark hover:text-primary transition-colors font-medium py-2 border-b border-gray-100">报名通道</a>
                <!-- 移动端立即报名按钮 -->
                <a href="#registration" class="sys-btn bg-primary text-white px-4 py-2 rounded-md hover:bg-primary/90 transition-colors w-full text-center">
                    立即报名
                </a>
            </div>
        </div>
    </header>

    <!-- 首页部分 -->
    <section id="home" class="pt-24 pb-16">
        <!-- 轮播图：修复变红问题 + 适配不同系统的渲染 -->
        <div class="relative h-[70vh] md:h-[80vh] overflow-hidden">
            <div id="carousel" class="flex h-full transition-transform duration-500 ease-in-out">
                <div class="w-full flex-shrink-0 h-full relative">
                    <!-- 轮播图第一张 - 新增carousel-img类修复变红 -->
                    <img src="img/banner3.jpg" alt="太平宫新貌全景" class="carousel-img w-full h-full object-cover">
                    <div class="absolute inset-0 bg-dark/40 flex items-center justify-center">
                        <h1 class="text-white text-4xl md:text-6xl font-bold text-center px-4 text-shadow">
                            龙脉之下，古庙新生
                        </h1>
                    </div>
                </div>
                <div class="w-full flex-shrink-0 h-full relative">
                    <!-- 轮播图第二张 - 新增carousel-img类修复变红 -->
                    <img src="img/banner2.jpg" alt="六尊佛像庄严特写" class="carousel-img w-full h-full object-cover">
                    <div class="absolute inset-0 bg-dark/40 flex items-center justify-center">
                        <h1 class="text-white text-4xl md:text-6xl font-bold text-center px-4 text-shadow">
                            供奉六圣，福泽一方
                        </h1>
                    </div>
                </div>
                <div class="w-full flex-shrink-0 h-full relative">
                    <!-- 轮播图第三张 - 新增carousel-img类修复变红 -->
                    <img src="img/banner5.jpg" alt="重建历程拼图" class="carousel-img w-full h-full object-cover">
                    <div class="absolute inset-0 bg-dark/40 flex items-center justify-center">
                        <h1 class="text-white text-4xl md:text-6xl font-bold text-center px-4 text-shadow">
                            薪火相传，再续华章
                        </h1>
                    </div>
                </div>
            </div>
            <!-- 轮播控制按钮：适配不同系统的点击样式 -->
            <button id="prevBtn" class="sys-btn absolute left-4 top-1/2 -translate-y-1/2 bg-white/30 hover:bg-white/50 text-white w-10 h-10 rounded-full flex items-center justify-center transition-colors">
                <i class="fa fa-chevron-left"></i>
            </button>
            <button id="nextBtn" class="sys-btn absolute right-4 top-1/2 -translate-y-1/2 bg-white/30 hover:bg-white/50 text-white w-10 h-10 rounded-full flex items-center justify-center transition-colors">
                <i class="fa fa-chevron-right"></i>
            </button>
            <!-- 轮播指示器 -->
            <div id="carouselIndicators" class="absolute bottom-6 left-1/2 -translate-x-1/2 flex space-x-3">
                <button class="sys-btn w-3 h-3 rounded-full bg-white opacity-100"></button>
                <button class="sys-btn w-3 h-3 rounded-full bg-white opacity-50"></button>
                <button class="sys-btn w-3 h-3 rounded-full bg-white opacity-50"></button>
            </div>
        </div>

        <!-- 邀请函核心代码（已优化格式，字体缩小） -->
        <div class="container mx-auto px-4 py-12 md:py-16">
            <div class="max-w-3xl mx-auto bg-white p-8 rounded-lg shadow-lg">
                <!-- 取消标题空两格，字体缩小 -->
                <p class="text-base md:text-lg invitation-title" 
                   style="font-family: 'Noto Serif SC', 'STSong', 'SimSun', serif; color: #8B0000;">
                    尊敬的各位善信、嘉宾：
                </p>
                <!-- 正文段落空两格，字体缩小 -->
                <p class="text-base md:text-lg invitation-text" 
                   style="font-family: 'Noto Serif SC', 'STSong', 'SimSun', serif; color: #8B0000;">
                    感化里和坑冬内山脚，仙境实地今起威宇华庭。
                </p>
				<p class="text-base md:text-lg invitation-text" 
                   style="font-family: 'Noto Serif SC', 'STSong', 'SimSun', serif; color: #8B0000;">
                    溪南和坑太平宫为共襄盛举，拟定于2025年12月29日（农历十一月初十），举行重建盛大落成庆典。届时将进行巡游活动及佛像入宫仪式，并有舞狮、乐队、歌舞等到场助兴。佛恩浩荡，活动期间太平宫膳食区将为所有来客提供免费美食。
                </p>

                <p class="text-base md:text-lg invitation-text" 
                   style="font-family: 'Noto Serif SC', 'STSong', 'SimSun', serif; color: #8B0000;">
                    现诚邀广大善信、嘉宾莅临现场，共沐佛恩、同沾法喜。美丽太平宫期待与您温暖邂逅。
                </p>
                <p class="text-base md:text-lg invitation-text" 
                   style="font-family: 'Noto Serif SC', 'STSong', 'SimSun', serif; color: #8B0000;">
                    敬祝吉祥如意、福慧双增。
                </p>
                
                <div class="invitation落款 text-base md:text-lg" 
                     style="font-family: 'Noto Serif SC', 'STSong', 'SimSun', serif; color: #8B0000;">
                    和坑太平宫重建理事会<br>
                    二零二五年冬月
                </div>
                
                <p class="text-sm mt-6 text-gray-600 italic text-center"
                   style="font-family: 'Noto Serif SC', 'STSong', 'SimSun', serif;">
                    温馨提示：为确保庆典期间道路通畅，凡当日参加活动的机动车，车流高峰期，返回时建议绕转大坑至溪南中学路线行驶。多谢配合，祝您一路顺风！
                </p>
            </div>
        </div>
    </section>

    <!-- 活动流程：适配不同系统的表格渲染（仅保留时间、活动内容两列） -->
    <section id="process" class="py-16 bg-light">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-primary mb-4">活动流程</h2>
                <div class="w-20 h-1 bg-accent mx-auto"></div>
                <p class="mt-4 text-lg">详细了解庆典各环节安排，共赴圆满盛会</p>
            </div>

            <div class="overflow-x-auto">
                <table class="w-full bg-white rounded-lg shadow-lg overflow-hidden">
                    <thead class="bg-primary text-white">
                        <tr>
                            <th class="py-4 px-6 text-left text-lg">时间</th>
                            <th class="py-4 px-6 text-left text-lg">活动内容</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                        <tr class="hover:bg-light/50 transition-colors">
                            <td class="py-4 px-6 font-medium">6:40 ~ 7:00</td>
                            <td class="py-4 px-6 font-medium text-primary">迎接众佛</td>
                        </tr>
                        <tr class="hover:bg-light/50 transition-colors">
                            <td class="py-4 px-6 font-medium">7:00 ~ 8:20</td>
                            <td class="py-4 px-6 font-medium text-primary">众佛巡游</td>
                        </tr>
                        <tr class="hover:bg-light/50 transition-colors">
                            <td class="py-4 px-6 font-medium">8:20 ~ 8:50</td>
                            <td class="py-4 px-6 font-medium text-primary">众佛入宫</td>
                        </tr>
                        <tr class="hover:bg-light/50 transition-colors">
                            <td class="py-4 px-6 font-medium">8:50 ~ 9:00</td>
                            <td class="py-4 px-6 font-medium text-primary">揭牌仪式</td>
                        </tr>
                        <tr class="hover:bg-light/50 transition-colors">
                            <td class="py-4 px-6 font-medium">9:00 ~ 9:10</td>
                            <td class="py-4 px-6 font-medium text-primary">升国旗</td>
                        </tr>
                        <tr class="hover:bg-light/50 transition-colors">
                            <td class="py-4 px-6 font-medium">9:10 ~ 9:40</td>
                            <td class="py-4 px-6 font-medium text-primary">舞狮表演</td>
                        </tr>
                        <tr class="hover:bg-light/50 transition-colors">
                            <td class="py-4 px-6 font-medium">9:40 ~ 10:00</td>
                            <td class="py-4 px-6 font-medium text-primary">锣鼓队</td>
                        </tr>
                        <tr class="hover:bg-light/50 transition-colors">
                            <td class="py-4 px-6 font-medium">10:00 ~ 11:00</td>
                            <td class="py-4 px-6 font-medium text-primary">歌舞1</td>
                        </tr>
                        <tr class="hover:bg-light/50 transition-colors">
                            <td class="py-4 px-6 font-medium">11:00 ~ 13:00</td>
                            <td class="py-4 px-6 font-medium text-primary">午饭</td>
                        </tr>
                        <tr class="hover:bg-light/50 transition-colors bg-secondary/20">
                            <td class="py-4 px-6 font-medium">13:00 ~ 15:00</td>
                            <td class="py-4 px-6 font-medium text-primary">歌舞2</td>
                        </tr>
                        <tr class="hover:bg-light/50 transition-colors bg-secondary/20">
                            <td class="py-4 px-6 font-medium">15:00 ~ 16:30</td>
                            <td class="py-4 px-6 font-medium text-primary">礼品发放</td>
                        </tr>
                        <tr class="hover:bg-light/50 transition-colors bg-secondary/20">
                            <td class="py-4 px-6 font-medium">16:30 ~ 17:00</td>
                            <td class="py-4 px-6 font-medium text-primary">礼佛结束</td>
                        </tr>
                        <tr class="hover:bg-light/50 transition-colors">
                            <td class="py-4 px-6 font-medium">17:00以后</td>
                            <td class="py-4 px-6 font-medium text-primary">歌舞3</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- 温馨提示 -->
            <div class="mt-12 bg-white p-8 rounded-lg shadow-md">
                <h3 class="text-2xl font-bold text-primary mb-6 flex items-center">
                    <i class="fa fa-exclamation-circle mr-2"></i>温馨提示
                </h3>
                <ul class="space-y-3 text-lg">
                    <li class="flex items-start">
                        <i class="fa fa-check text-accent mt-1 mr-3"></i>
                        <span>活动期间人员较多，请遵守现场秩序，听从工作人员指引，文明参与各环节</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fa fa-check text-accent mt-1 mr-3"></i>
                        <span>祈福专区设有香案，可按需参与祈福，请勿擅自触碰殿内文物及佛像</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fa fa-check text-accent mt-1 mr-3"></i>
                        <span>现场提供饮用水、急救物资等便民服务，如有需求可联系工作人员</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fa fa-check text-accent mt-1 mr-3"></i>
                        <span>建议提前规划出行路线，预留充足时间到达现场，避免拥堵</span>
                    </li>
                </ul>
            </div>
        </div>
    </section>

    <!-- 庆典概况：适配不同系统的布局与地图渲染（移除四个意义模块） -->
    <section id="overview" class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-primary mb-4">庆典概况</h2>
                <div class="w-20 h-1 bg-accent mx-auto"></div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-10 items-center">
                <div class="hover-scale">
                    <img src="img/banner4.jpg" alt="庆典活动现场效果图" class="carousel-img w-full h-auto rounded-lg shadow-lg">
                </div>
                <div class="space-y-6">
                    <div>
                        <h3 class="text-xl font-bold text-dark mb-2 flex items-center">
                            <i class="fa fa-tag text-primary mr-2"></i>活动主题
                        </h3>
                        <p class="text-lg">古宫焕新·福泽永续——和坑太平宫重建庆典</p>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-dark mb-2 flex items-center">
                            <i class="fa fa-calendar text-primary mr-2"></i>举办时间
                        </h3>
                        <p class="text-lg">二〇二五年十二月二十九日（農历十一月初十）</p>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-dark mb-2 flex items-center">
                            <i class="fa fa-map-marker text-primary mr-2"></i>举办地点
                        </h3>
                        <p class="text-lg">感化里和坑太平宫（酉山卯向己酉己卯分金）</p>
                        
                        <!-- 高德地图展示容器：适配不同系统的地图渲染 -->
                        <div id="taipinggong-map" class="w-full h-64 rounded-lg border border-gray-200 my-4"></div>
                        
                        <!-- 地图导航按钮：优化高德跳转，移除百度地图，苹果地图始终显示 -->
                        <div class="mt-4 flex flex-wrap gap-3">
                            <!-- 高德地图：深度适配VIVO X300 OriginOS -->
                            <a id="amapNavBtn" href="javascript:void(0);" 
                               class="sys-btn flex items-center bg-[#00B42A] text-white px-4 py-2 rounded-md hover:bg-[#00A824] transition-colors">
                                <i class="fa fa-map-marker text-sm mr-2"></i> 高德地图
                            </a>
                            <!-- 苹果地图：始终显示 -->
                            <a id="appleMapBtn" href="http://maps.apple.com/?q=25.413564,117.555257&z=16" 
                               class="sys-btn flex items-center bg-gray-800 text-white px-4 py-2 rounded-md hover:bg-gray-700 transition-colors">
                                <i class="fa fa-map-o text-sm mr-2"></i> 苹果地图
                            </a>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-dark mb-2 flex items-center">
                            <i class="fa fa-users text-primary mr-2"></i>主办方
                        </h3>
                        <p class="text-lg">和坑太平宫重建理事会</p>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-dark mb-2 flex items-center">
                            <i class="fa fa-handshake-o text-primary mr-2"></i>支持单位
                        </h3>
                        <p class="text-lg">华懋（厦门）特种材料有限公司、各界捐资单位及热心人士</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 报名通道：适配不同系统的布局 -->
    <section id="registration" class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-primary mb-4">报名通道</h2>
                <div class="w-20 h-1 bg-accent mx-auto"></div>
                <p class="mt-4 text-lg">填写报名信息，锁定庆典席位</p>
            </div>

            <div class="max-w-md mx-auto">
                <div class="bg-light p-8 rounded-lg shadow-lg">
                    <h3 class="text-2xl font-bold text-primary mb-6 text-center">扫码快速报名</h3>
                    <div class="flex justify-center">
                        <div class="w-64 h-64 bg-white flex items-center justify-center border-2 border-primary/30 rounded-lg p-4">
                            <img src="img/qrcode.jpg" alt="报名二维码" class="carousel-img w-full h-full object-cover">
                        </div>
                    </div>
                    <p class="text-center mt-4 text-lg">扫码即可填写表单，快速锁定席位</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 底部版权信息 -->
    <footer class="bg-dark text-white py-8">
        <div class="container mx-auto px-4 text-center">
            <p class="text-lg mb-2">和坑太平宫重建理事会 版权所有</p>
            <p class="text-sm opacity-80">地址：感化里和坑太平宫 | 联系电话：0596-XXXXXXX</p>
            <p class="text-sm opacity-80 mt-2">© 2025 太平宫重建庆典 保留所有权利</p>
        </div>
    </footer>

    <!-- 先加载高德地图API（修复加载顺序问题） -->
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=2.0&key=9f764a879b3650b035142ae657e0ac46&plugin=AMap.Geolocation,AMap.ToolBar"></script>
    
    <!-- 核心交互脚本（深度适配VIVO X300） -->
    <script>
        // 移动端菜单切换
        document.getElementById('menuBtn').addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobileMenu');
            mobileMenu.classList.toggle('hidden');
        });

        // 导航栏滚动效果
        window.addEventListener('scroll', function() {
            const navbar = document.getElementById('navbar');
            if (window.scrollY > 50) {
                navbar.classList.add('bg-white', 'shadow-lg');
                navbar.classList.remove('bg-white/90');
            } else {
                navbar.classList.remove('bg-white', 'shadow-lg');
                navbar.classList.add('bg-white/90');
            }
        });

        // 轮播图脚本 - 修复核心问题
        let currentSlide = 0;
        const slides = document.querySelectorAll('#carousel > div');
        const indicators = document.querySelectorAll('#carouselIndicators button');
        
        function showSlide(index) {
            const carousel = document.getElementById('carousel');
            carousel.style.transform = `translateX(-${index * 100}%)`;
            indicators.forEach((btn, i) => {
                btn.style.opacity = i === index ? '1' : '0.5';
            });
            currentSlide = index;
        }
        
        document.getElementById('nextBtn').addEventListener('click', function() {
            let nextSlide = (currentSlide + 1) % slides.length;
            showSlide(nextSlide);
        });
        
        document.getElementById('prevBtn').addEventListener('click', function() {
            let prevSlide = (currentSlide - 1 + slides.length) % slides.length;
            showSlide(prevSlide);
        });
        
        setInterval(() => {
            let nextSlide = (currentSlide + 1) % slides.length;
            showSlide(nextSlide);
        }, 5000);
        
        // 增强版设备检测（精准识别VIVO X300/OriginOS）
        function detectDevice() {
            const ua = navigator.userAgent;
            return {
                isMobile: /iPhone|iPad|iPod|Android/i.test(ua),
                isIOS: /iPhone|iPad|iPod/i.test(ua),
                isAndroid: /Android/i.test(ua),
                // 精准识别VIVO设备（包含X300/OriginOS）
                isVIVO: /vivo|VIVO|X300|OriginOS/i.test(ua),
                isPC: !/iPhone|iPad|iPod|Android/i.test(ua)
            };
        }
        
        // 初始化地图导航按钮（深度适配VIVO X300）
        function initMapNavButtons() {
            const device = detectDevice();
            const amapBtn = document.getElementById('amapNavBtn');
            // 核心坐标（固化，避免参数传递错误）
            const lat = 25.413564;
            const lng = 117.555257;
            const name = encodeURIComponent('和坑太平宫');
            
            amapBtn.addEventListener('click', function() {
                // 1. 纯坐标网页版URL（不依赖地名搜索）
                const amapWebUrl = `https://amap.com/map/navigation?lat=${lat}&lng=${lng}&name=${name}&type=car&policy=1`;
                
                if (device.isVIVO) {
                    // VIVO X300/OriginOS 专属解决方案
                    // 方案1：使用Intent跳转（最稳定的VIVO适配方式）
                    const intentUrl = `intent://navi/#Intent;scheme=amapuri;package=com.autonavi.minimap;action=android.intent.action.VIEW;category=android.intent.category.DEFAULT;component=com.autonavi.minimap/.api.bundle.MapActivity;S.dlat=${lat};S.dlon=${lng};S.dname=${name};S.dev=0;S.t=0;end`;
                    
                    // 方案2：备用协议
                    const backupUrl = `amap://navi?sourceApplication=amap&lat=${lat}&lon=${lng}&dev=0&style=2`;
                    
                    try {
                        // 优先使用Intent方式（VIVO官方推荐）
                        window.location.href = intentUrl;
                        
                        // 1.5秒后检测是否跳转成功，失败则尝试备用协议
                        setTimeout(() => {
                            window.location.href = backupUrl;
                        }, 1500);
                        
                        // 3秒后降级到纯坐标网页版
                        setTimeout(() => {
                            window.open(amapWebUrl, '_blank');
                        }, 3000);
                    } catch (e) {
                        // 异常处理：直接打开网页版
                        window.open(amapWebUrl, '_blank');
                    }
                    
                } else if (device.isAndroid) {
                    // 普通安卓设备
                    const amapAndroidUrl = `amapuri://route/plan/?dlat=${lat}&dlon=${lng}&dname=${name}&dev=0&t=0`;
                    window.location.href = amapAndroidUrl;
                    setTimeout(() => {
                        window.open(amapWebUrl, '_blank');
                    }, 2000);
                    
                } else if (device.isIOS) {
                    // IOS设备
                    const amapIOSUrl = `iosamap://path?sourceApplication=applicationName&dlat=${lat}&dlon=${lng}&dname=${name}&dev=0&t=0`;
                    window.location.href = amapIOSUrl;
                    setTimeout(() => {
                        window.open(amapWebUrl, '_blank');
                    }, 2000);
                    
                } else {
                    // PC端 - 纯坐标定位（不依赖地名）
                    const pcAmapUrl = `https://www.amap.com/map/marker?position=${lng},${lat}&name=${name}&zoom=16`;
                    window.open(pcAmapUrl, '_blank');
                }
            });
        }
        
        // 初始化高德地图（纯坐标渲染，不依赖地名搜索）
        function initAmap() {
            try {
                const device = detectDevice();
                const lat = 25.413564;
                const lng = 117.555257;
                
                // 初始化地图 - 纯坐标配置
                const map = new AMap.Map('taipinggong-map', {
                    zoom: device.isMobile ? 16 : 17, // 放大层级，精准定位
                    center: [lng, lat],
                    resizeEnable: true,
                    features: ['bg', 'road', 'building', 'point'],
                    viewMode: '2D',
                    mapStyle: 'amap://styles/normal'
                });
                
                // 添加精准标记点
                const marker = new AMap.Marker({
                    position: [lng, lat],
                    title: '和坑太平宫',
                    map: map,
                    icon: new AMap.Icon({
                        size: new AMap.Size(40, 40), // 放大标记，更易识别
                        image: 'https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png',
                        imageSize: new AMap.Size(40, 40)
                    }),
                    offset: new AMap.Pixel(-20, -40) // 校准标记位置
                });
                
                // 信息窗口 - 简化名称，提高识别率
                const infoWindow = new AMap.InfoWindow({
                    content: '<div style="padding: 10px;"><h3 style="color: #C41E3A; font-size: 16px; margin-bottom: 5px;">和坑太平宫</h3><p style="font-size: 14px;">坐标：25.413564, 117.555257</p></div>',
                    offset: new AMap.Pixel(0, -40)
                });
                
                marker.on('click', function() {
                    infoWindow.open(map, marker.getPosition());
                });
                
                // 添加地图控件
                map.addControl(new AMap.ToolBar({
                    position: 'RB',
                    liteStyle: device.isMobile
                }));
                
                // 地图点击事件 - 纯坐标导航
                map.on('click', function() {
                    if (device.isMobile) {
                        const confirmNav = confirm('是否打开高德地图导航至太平宫？');
                        if (confirmNav) {
                            const amapWebUrl = `https://amap.com/map/navigation?lat=${lat}&lng=${lng}&name=和坑太平宫&type=car&policy=1`;
                            
                            if (device.isVIVO) {
                                const intentUrl = `intent://navi/#Intent;scheme=amapuri;package=com.autonavi.minimap;action=android.intent.action.VIEW;category=android.intent.category.DEFAULT;component=com.autonavi.minimap/.api.bundle.MapActivity;S.dlat=${lat};S.dlon=${lng};S.dname=和坑太平宫;S.dev=0;S.t=0;end`;
                                window.location.href = intentUrl;
                                setTimeout(() => window.open(amapWebUrl, '_blank'), 2000);
                            } else if (device.isAndroid) {
                                const amapAndroidUrl = `amapuri://route/plan/?dlat=${lat}&dlon=${lng}&dname=和坑太平宫&dev=0&t=0`;
                                window.location.href = amapAndroidUrl;
                                setTimeout(() => window.open(amapWebUrl, '_blank'), 2000);
                            } else if (device.isIOS) {
                                const amapIOSUrl = `iosamap://path?sourceApplication=applicationName&dlat=${lat}&dlon=${lng}&dname=和坑太平宫&dev=0&t=0`;
                                window.location.href = amapIOSUrl;
                                setTimeout(() => window.open(amapWebUrl, '_blank'), 2000);
                            }
                        }
                    }
                });
                
                map.on('complete', function() {
                    console.log('高德地图加载完成，坐标：', lat, lng);
                });
                
            } catch (e) {
                console.error('地图初始化失败:', e);
                // 降级处理：显示带精准坐标的静态地图
                const lat = 25.413564;
                const lng = 117.555257;
                document.getElementById('taipinggong-map').innerHTML = `
                    <img src="https://restapi.amap.com/v3/staticmap?location=${lng},${lat}&zoom=17&size=800*500&markers=mid,,A:${lng},${lat}&key=9f764a879b3650b035142ae657e0ac46" 
                         alt="和坑太平宫位置" 
                         class="w-full h-full object-cover rounded-lg">
                    <div class="mt-2 text-center text-sm text-gray-600">坐标：${lat}, ${lng}</div>
                `;
            }
        }
        
        // 页面加载完成后初始化
        window.addEventListener('load', function() {
            initMapNavButtons();
            setTimeout(initAmap, 500);
            
            // 苹果端样式优化
            const device = detectDevice();
            if (device.isIOS) {
                const inputs = document.querySelectorAll('input, textarea, button');
                inputs.forEach(el => {
                    el.style.appearance = 'none';
                    el.style.borderRadius = '6px';
                });
            }

            // 平滑滚动
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    
                    if (targetElement) {
                        const navbarHeight = document.getElementById('navbar').offsetHeight;
                        const targetPosition = targetElement.getBoundingClientRect().top + window.pageYOffset - navbarHeight;
                        
                        window.scrollTo({
                            top: targetPosition,
                            behavior: 'smooth'
                        });
                        
                        if (window.innerWidth < 768) {
                            document.getElementById('mobileMenu').classList.add('hidden');
                        }
                    }
                });
            });
        });
    </script>
</body>
</html>
